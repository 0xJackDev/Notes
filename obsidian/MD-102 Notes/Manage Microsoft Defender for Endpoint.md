

Microsoft Defender for Endpoint, formerly Windows Defender Advanced Threat Protection, is a sophisticated cloud-based service designed to help organizations identify, investigate, and respond to advanced persistent threats. This cutting-edge solution offers behavior-driven attack detection, a comprehensive forensic timeline, and an unparalleled threat intelligence knowledge base. By applying these advanced features, organizations can proactively combat evolving cyber threats and enhance security.

After this module, you should be able to:

- Describe Microsoft Defender for Endpoint.
- Describe key capabilities of Microsoft Defender for Endpoint.
- Describe Microsoft Defender Application Guard.
- Describe Microsoft Defender Exploit Guard.
- Describe Windows Defender System Guard.



Microsoft defender for endpoint is a platform designed to help enterprise network prevent and detect, investage and respond to advanced threats. Unlike Microsoft defender which is available on each windows computer and managed by group policy or intune, Microsoft Defender for endpoint is a whole new platform that helps administrators enhance security and establish centralized security control over both cloud and on-premises resources. Although Microsoft defender for endpoint shares the same name as Microsoft Defender in Windows, these aren't the same products. Administrators can use Microsoft Defender for Endpoint to monitor Microsoft Defender functionalities on local Windows clients to maintain consistent configuration and an acceptable security level. However, besides this, Microsoft Defender for Endpoint can also integrate with Microsoft 365 Threat Intelligence, Cloud App Security, Azure ATP, and Intune. It can also detect potentially harmful content in Skype for Business communications.


Microsoft Defender for Endpoint uses the following combination of technologies built into Windows and Microsoft's cloud service:

- **Endpoint behavioral sensors:** Embedded in Windows, these sensors collect and process behavioral signals from the operating system and send this sensor data to your private, isolated, cloud instance of Microsoft Defender for Endpoint.
- **Cloud security analytics:** Using big-data, machine-learning, and unique Microsoft optics across the Windows ecosystem, enterprise cloud products (such as Microsoft 365), and online assets - behavioral signals are translated into insights, detections, and recommended responses to advanced threats.
- **Threat intelligence:** Generated by Microsoft hunters, security teams, and augmented by threat intelligence provided by partners, threat intelligence enables Microsoft Defender for Endpoint to identify attacker tools, techniques, and procedures, and generate alerts when these are observed in collected sensor data.

These technologies, combined together, provide efficient proactive monitoring of what happens on your client machines, servers and network. They perform automated investigations on well-known incidents and provide some actions even before an administrator is alerted.

The main console for Microsoft Defender for Endpoint is the Microsoft 365 Security Center. Enterprise security teams can use Microsoft 365 Security Center to monitor and help responding to alerts of potential advanced persistent threat (APT) activity or data breaches.

You can use Microsoft 365 Security Center to:

- View, sort, and triage alerts from your endpoints.
- Search for more information on observed indicators such as files and IP addresses.
- Change Microsoft Defender for Endpoint settings, including time zone and review licensing information.

[![Screenshot of the Windows Defender Security Center screen.](https://learn.microsoft.com/en-us/training/wwl/manage-defender-endpoint/media/alert-dashboard-92252985.png)](https://learn.microsoft.com/en-us/training/wwl/manage-defender-endpoint/media/alert-dashboard-92252985.png#lightbox)

### Windows Defender Application Control

Typically, a user-initiated process has the same level of data access as the user, putting sensitive information at risk of being deleted or leaked if the user intentionally or inadvertently runs malicious software. Application control moves away from the traditional trust model, where all applications are assumed trustworthy by default, to one where applications must establish their trustworthiness to operate.

For a system to function correctly, its executables must be checked and verified using code signatures from software publishers. However, some Windows executables may need proper signatures. To address this, an administrator can create a list of all unsigned code files on the system and have the organization sign it. This list is then deployed to Windows Enterprise PCs. Once the Windows Defender Application Control (WDAC) is enabled, any executable not listed in this policy file will be blocked from running. Furthermore, WDAC policies also prevent the execution of unsigned scripts, MSIs, and Windows PowerShell.

Application Control is well suited for Point of Service (PoS) devices, such as sales terminals, ATMs, similar devices, server-based desktops (virtual desktop infrastructure), or other devices where the OS is relatively consistent and updated infrequently. Since code from Windows Update is signed, Windows installations should continue to run securely, even as the OS and Microsoft applications receive updates with new fixes and features. Organizations must carefully consider how to include third-party applications that update frequently but lack signatures.


### Windows Defender Device Guard

Device Guard combines the features of Application Control with the ability to use the Windows Hyper-V hypervisor to protect Windows kernel-mode processes against the injection and execution of malicious or unverified code. While WDAC doesn't require specific hardware or software, enabling Hypervisor protected code integrity (HVCI) requires compatible hardware and drivers.



Microsoft Defender Application Guard (Application Guard) is designed to help prevent old and newly emerging attacks to help keep employees productive. Using Microsoft's unique hardware isolation approach, the goal of Application Guard is to destroy the playbook that attackers use by rendering current attack methods obsolete.

Designed for Windows and Microsoft Edge, Application Guard helps to isolate enterprise-defined untrusted sites, protecting your company while your employees browse the internet. As an enterprise administrator, you define what is among trusted websites, cloud resources, and internal networks. Everything not on your list is considered untrusted.

If an employee goes to an untrusted site through either Microsoft Edge or Internet Explorer, Microsoft Edge opens the site in an isolated Hyper-V-enabled container, which is separate from the host operating system. This container isolation means that if the untrusted site turns out to be malicious, the host PC is protected, and the attacker can't get to your enterprise data. For example, this approach makes the isolated container anonymous, so an attacker can't get to your employee's enterprise credentials.

### Configuring Application Guard

To enable Application Guard in Microsoft Edge, use the following steps:

1. Open Control Panel.
2. Select on **Programs**.
3. Select the **Turn Windows features on or off** link.
4. Check the **Microsoft Defender Application Guard** option. If that option isn't available to select, it's probably because your hardware doesn't support this feature.
5. Select **OK**.
6. Select **Restart now**.### Maintain the integrity of the system as it starts

In the past, during the Windows 7 era, attackers often used bootkits or rootkits to persist and evade detection. These malicious software would initiate before or during the Windows boot process, granting them the highest level of privilege.

With modern hardware certified for Windows 8 or higher, a hardware-based root of trust helps prevent unauthorized firmware or software, such as bootkits, from executing before the Windows bootloader. This added security is achieved through the device's Secure Boot feature, a part of the Unified Extensible Firmware Interface (UEFI).

After the device's firmware and Windows bootloader have been verified and initiated, the next opportunity for attackers to compromise system integrity arises during the startup of the Windows operating system and its defenses. By embedding rootkit-based malicious code into the boot process, attackers can gain the highest level of privilege, which enables easier persistence and evasion.

Windows Defender System Guard steps in at this point, ensuring that only properly signed and secure Windows files and drivers, including third-party ones, can start on the device. Once the Windows boot process concludes, System Guard initiates the system's antimalware solution to scan all third-party drivers. Ultimately, Windows Defender System Guard helps guarantee a secure boot with integrity, preventing system compromise before the rest of the defenses begin.

![Diagram of Windows Defender System Guard Boot time integrity Protection.](https://learn.microsoft.com/en-us/training/wwl/manage-defender-endpoint/media/defender-system-guard-74d54d3f.png)

### Maintain integrity of the system after it’s running (run time)

Prior to Windows 10, if an attacker exploited the system and gained SYSTEM level privilege or they compromised the kernel itself, they were able to make significant damage to the attacked system. The level of control that an attacker would acquire in this condition would enable them to tamper with and bypass many, if not all, of your system defenses. While there are many development practices and technologies such as **Windows Defender Exploit Guard** that have made it difficult to gain this level of privilege in Windows, the reality is that there needs to be a way to maintain the integrity of the most sensitive Windows services and data, even if the highest level of privilege is secured by an adversary.

With Windows 10, Microsoft introduced the concept of virtualization-based security (VBS), which enables us to contain the most sensitive Windows services and data in hardware-based isolation, which is the Windows Defender System Guard container. This secure environment provides the hardware-based security boundary needed to be able to secure and maintain the integrity of critical system services at run time like Credential Guard, Device Guard, Virtual Trusted Platform Module (TPM) and parts of Windows Defender Exploit Guard, just to name a few.

### Validate platform integrity after Windows is running (run time)

While Windows Defender System Guard provides advanced protection that will help protect and maintain the integrity of the platform during boot and at run time, the reality is that an "assume breach" mentality must be applied to even the most sophisticated security technologies. Organizations should be able to trust that the technologies are successfully doing their jobs, but they also need the ability to verify that they were successful in achieving their goals. When it comes to platform integrity, the platform can't just be trusted, which potentially could be compromised, to self-attest to its security state. So, Windows Defender System Guard includes a series of technologies that enable remote analysis of the device’s integrity.

As Windows boots, a series of integrity measurements are taken by Windows Defender System Guard using the device’s TPM 2.0. This process and data are hardware-isolated away from Windows to help ensure that the measurement data isn't subject to the type of tampering that could happen if the platform was compromised. From here, the measurements can be used to determine the integrity of the device’s firmware, hardware configuration state, and Windows boot-related components, just to name a few. After the system boots, Windows Defender System Guard signs and seals these measurements using the TPM. Upon request, a management system like Intune or Configuration Manager can acquire them for remote analysis. If Windows Defender System Guard indicates that the device lacks integrity, the management system can take a series of actions, such as denying the device access to resources.